<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Sprite Kitæ•™ç¨‹ï¼šå¦‚ä½•æ‹–æ”¾Sprites | ç ´èˆ¹ä¹‹å®¶</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="article">
<meta property="og:title" content="Sprite Kitæ•™ç¨‹ï¼šå¦‚ä½•æ‹–æ”¾Sprites">
<meta property="og:url" content="http://beyondvincent.com/2013/10/20/2013-10-19-117-spritekit-tutorial-how-to-drag-and-drop-sprites/index.html">
<meta property="og:site_name" content="ç ´èˆ¹ä¹‹å®¶">
<meta property="og:image" content="http://beyondvincent.com/images/2013/10/14.png">
<meta property="og:image" content="http://beyondvincent.com/images/2013/10/15.png">
<meta property="og:image" content="http://beyondvincent.com/images/2013/10/16.png">
<meta property="og:image" content="http://beyondvincent.com/images/2013/10/17.png">
<meta property="og:image" content="http://beyondvincent.com/images/2013/10/18.png">
<meta property="og:image" content="http://beyondvincent.com/images/2013/10/19.png">
<meta property="og:image" content="http://beyondvincent.com/images/2013/10/20.png">
<meta property="og:image" content="http://beyondvincent.com/images/2013/10/21.png">
<meta property="og:image" content="http://beyondvincent.com/images/2013/10/22.png">
<meta property="og:image" content="http://beyondvincent.com/images/2013/10/23.png">
<meta property="og:updated_time" content="2014-12-31T19:05:45.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Sprite Kitæ•™ç¨‹ï¼šå¦‚ä½•æ‹–æ”¾Sprites">
<meta name="twitter:image" content="http://beyondvincent.com/images/2013/10/14.png">
  
    <link rel="alternative" href="/atom.xml" title="ç ´èˆ¹ä¹‹å®¶" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  

  <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<div class="profilepic">
			<img src="https://avatars1.githubusercontent.com/u/3365146?v=3&amp;s=460">
		</div>

		<hgroup>
		  <h1 class="header-author"><a href="/">ç ´èˆ¹ä¹‹å®¶</a></h1>
		</hgroup>

		
		<p class="header-subtitle">å»ç•™æ— æ„ï¼Œæ¼«éšå¤©å¤–äº‘å·äº‘èˆ’</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>èœå•</li>
						<li>æ ‡ç­¾</li>
						
						<li>å‹æƒ…é“¾æ¥</li>
						
						
						<li>å…³äºæˆ‘</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">ä¸»é¡µ</a></li>
				        
							<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
				        
							<li><a href="/instagram">ç›¸å†Œ</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/BeyondVincent" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/beyondvincent" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="http://beyondvincent.com/atom.xml" title="rss">rss</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://luyutommycool.github.io/">å¢å®‡çš„åšå®¢</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://macshuo.com/">MacTalk</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.devtang.com/">å”å·§çš„åšå®¢</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://onevcat.com/">ç‹å·çš„åšå®¢</a>
			        
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					æˆ‘å°±æ˜¯æˆ‘ï¼Œæ˜¯é¢œè‰²ä¸ä¸€æ ·çš„çƒŸç«â€¦
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay"></div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="https://avatars1.githubusercontent.com/u/3365146?v=3&amp;s=460">
			</div>

			<hgroup>
			  <h1 class="header-author"><a href="/">ç ´èˆ¹ä¹‹å®¶</a></h1>
			</hgroup>
			
			<p class="header-subtitle">å»ç•™æ— æ„ï¼Œæ¼«éšå¤©å¤–äº‘å·äº‘èˆ’</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é¡µ</a></li>
		        
					<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
		        
					<li><a href="/instagram">ç›¸å†Œ</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/BeyondVincent" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/beyondvincent" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="http://beyondvincent.com/atom.xml" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <article id="post-2013-10-19-117-spritekit-tutorial-how-to-drag-and-drop-sprites" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/10/20/2013-10-19-117-spritekit-tutorial-how-to-drag-and-drop-sprites/" class="article-date">
  	<time datetime="2013-10-20T15:44:00.000Z" itemprop="datePublished">10æœˆ 20 2013</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOSç¿»è¯‘/">iOSç¿»è¯‘</a>
  </div>

      
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Sprite Kitæ•™ç¨‹ï¼šå¦‚ä½•æ‹–æ”¾Sprites
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <img src="/images/2013/10/14.png">
<a id="more"></a>
<p>æ³¨ï¼šæœ¬æ–‡è¯‘è‡ª<a href="http://www.raywenderlich.com/44270/sprite-kit-tutorial-how-to-drag-and-drop-sprites" target="_blank" rel="external"><code>Sprite Kit Tutorial: How To Drag and Drop Sprites</code></a></p>
<p>###<strong>ç›®å½•</strong></p>
<ul>
<li><a href="#ks">å¼€å§‹</a></li>
<li><a href="#xzjs">ç”¨è§¦æ‘¸çš„æ–¹å¼é€‰ä¸­sprite</a></li>
<li><a href="#ydjl">ç”¨è§¦æ‘¸çš„æ–¹å¼ç§»åŠ¨spriteå’Œlayer</a></li>
<li><a href="#sssb">åœ¨Sprite Kitä¸­å¦‚ä½•ä½¿ç”¨æ‰‹åŠ¿è¯†åˆ«</a></li>
<li><a href="#hqhc">ä½•å»ä½•ä»</a></li>
</ul>
<p>æœ¬æ–‡ä¸­ï¼Œä½ å¯ä»¥å­¦åˆ°å¦‚ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>åˆ©ç”¨è§¦æ‘¸æ¥æ‹–æ”¾spriteçš„åŸºæœ¬çŸ¥è¯†</li>
<li>åˆ©ç”¨è§¦æ‘¸æ»šåŠ¨view</li>
<li>How to keep coordinates straight in your head</li>
<li>å¦‚ä½•åœ¨Sprite Kitä¸­ä½¿ç”¨æ‰‹åŠ¿è¯†åˆ«</li>
</ul>
<p>ä¸ºäº†è®©æœ¬æ–‡æœ‰è¶£ä¸€ç‚¹ï¼Œè¿™é‡Œæä¾›äº†ä¸€äº›å¯çˆ±çš„åŠ¨ç‰©å›¾ç‰‡ã€‚</p>
<p>æœ¬æ–‡å‡è®¾ä½ å·²ç»äº†è§£äº†Sprite Kitçš„ä¸€äº›åŸºæœ¬çŸ¥è¯†ã€‚å¦‚æœè¿˜ä¸äº†è§£çš„è¯ï¼Œå…ˆçœ‹çœ‹ä¸‹é¢çš„æ–‡ç« å§ï¼š</p>
<p><a href="http://beyondvincent.com/blog/2013/10/12/114-spritekit-tutorial-for-beginners-3/"><code>Sprite Kitæ•™ç¨‹ï¼šåˆå­¦è€… 1</code></a><br><a href="http://beyondvincent.com/blog/2013/09/29/113-spritekit-tutorial-for-beginners-2/"><code>Sprite Kitæ•™ç¨‹ï¼šåˆå­¦è€… 2</code></a><br><a href="http://beyondvincent.com/blog/2013/09/26/113-spritekit-tutorial-for-beginners-1/"><code>Sprite Kitæ•™ç¨‹ï¼šåˆå­¦è€… 3</code></a></p>
<p>è‹±æ–‡åŸæ–‡åœ¨è¿™é‡Œï¼š<a href="http://www.raywenderlich.com/42699/spritekit-tutorial-for-beginners" target="_blank" rel="external"><code>Sprite Kit Tutorial for Beginners</code></a></p>
<p>ä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹å§ã€‚</p>
<p>###<a id="ks"></a>å¼€å§‹</p>
<p>åœ¨å®ç°è§¦æ‘¸å¤„ç†ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„Sprite Kitå·¥ç¨‹ï¼Œå¹¶åœ¨sceneä¸­æ˜¾ç¤ºå‡ºä¸€äº›sprite(åŠ¨ç‰©)å’ŒèƒŒæ™¯ã€‚</p>
<p>æ‰“å¼€Xcodeï¼Œé€‰æ‹©<code>File\New Project\Application\SpriteKit Game</code>ï¼Œç„¶åå•å‡»<code>Next</code>ã€‚</p>
<p><img src="/images/2013/10/15.png" alt=""></p>
<p>å°†å·¥ç¨‹å‘½åä¸º<code>DragDrop</code>ï¼Œdevicesé€‰æ‹©<code>iPhone</code>ï¼Œç„¶åå•å‡»<code>Next</code>ï¼ŒæŠŠå·¥ç¨‹ä¿å­˜åˆ°ç£ç›˜ä¸­ã€‚</p>
<p><img src="/images/2013/10/16.png" alt=""></p>
<p>è·Ÿ<a href="http://beyondvincent.com/blog/2013/10/12/114-spritekit-tutorial-for-beginners-3/"><code>Sprite Kitæ•™ç¨‹ï¼šåˆå­¦è€… 1</code></a>ä¸€æ ·ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªç¨‹åºåªæ”¯æŒæ¨ªå±æ˜¾ç¤º(landscape)ã€‚æ‰€ä»¥åœ¨<code>Project Navigator</code>ä¸­é€‰ä¸­<code>DragDrop</code>å·¥ç¨‹ï¼Œç„¶åé€‰æ‹©<code>DragDrop</code> targetï¼Œåœ¨å¼¹å‡ºçš„ç”»é¢ä¸­ï¼Œåªéœ€è¦å‹¾é€‰ä¸Š<code>Landscape Left</code>å’Œ<code>Landscape Right</code>ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/images/2013/10/17.png" alt=""></p>
<p>æ‰“å¼€<code>ViewController.m</code>æ–‡ä»¶ï¼Œå¹¶ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢<code>viewDidLoad</code>æ–¹æ³•(ä»£ç è·Ÿä¹‹å‰çš„ä¸€æ ·)ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewWillLayoutSubviews</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">super</span> viewWillLayoutSubviews];</div><div class="line"> </div><div class="line">    <span class="comment">// Configure the view.</span></div><div class="line">    <span class="built_in">SKView</span> * skView = (<span class="built_in">SKView</span> *)<span class="keyword">self</span>.view;</div><div class="line">    <span class="keyword">if</span> (!skView.scene) &#123;</div><div class="line">      skView.showsFPS = <span class="literal">YES</span>;</div><div class="line">      skView.showsNodeCount = <span class="literal">YES</span>;</div><div class="line"> </div><div class="line">      <span class="comment">// Create and configure the scene.</span></div><div class="line">      <span class="built_in">SKScene</span> * scene = [MyScene sceneWithSize:skView.bounds.size];</div><div class="line">      scene.scaleMode = <span class="built_in">SKSceneScaleModeAspectFill</span>;</div><div class="line"> </div><div class="line">      <span class="comment">// Present the scene.</span></div><div class="line">      [skView presentScene:scene];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¥ç€æ¥è¿™é‡Œä¸‹è½½æœ¬æ–‡éœ€è¦ç”¨åˆ°çš„<a href="http://d1xzuxjlafny7l.cloudfront.net/downloads/DragDropImages.zip" target="_blank" rel="external">å›¾ç‰‡èµ„æº</a>ã€‚ä¸‹è½½å¹¶è§£å‹ä¹‹åï¼Œå°†æ‰€æœ‰çš„æ–‡ä»¶æ‹–åˆ°å·¥ç¨‹ä¸­ï¼Œå…¶ä¸­æŠŠ<code>Copy items into destination groupâ€™s folder (if needed)</code>å‹¾é€‰ä¸Šï¼Œç„¶åå•å‡»<code>Finish</code>ã€‚</p>
<p><img src="/images/2013/10/18.png" alt=""></p>
<p>å®Œæˆä¸Šé¢çš„æ­¥éª¤ä¹‹åï¼Œæ‰“å¼€<code>MyScene.m</code>æ–‡ä»¶ï¼Œå¹¶åœ¨<code>@implementation</code>ä¸Šé¢æ·»åŠ ä¸€ä¸ªclass extensionï¼Œå¹¶å£°æ˜ä¸¤ä¸ªå±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyScene</span> () </span></div><div class="line"> </div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">SKSpriteNode</span> *background;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">SKSpriteNode</span> *selectedNode;</div><div class="line"> </div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ç¨åä¼šç”¨åˆ°ä¸Šé¢çš„è¿™ä¸¤ä¸ªå±æ€§æ¥å­˜å‚¨èƒŒæ™¯å›¾ç‰‡ï¼Œå·²ç»å½“å‰é€‰ä¸­çš„node/spriteã€‚æ¥ç€åœ¨@interfaceå‰é¢æ·»åŠ å¦‚ä¸‹è¿™è¡Œä»£ç ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kAnimalNodeName = <span class="string">@"movable"</span>;</div></pre></td></tr></table></figure>
<p>ç¨åå°†ä¼šç”¨è¿™ä¸ªå­—ç¬¦ä¸²æ¥æ ‡ç¤ºå¯ç§»åŠ¨çš„nodeã€‚æ¥ç€æ‰¾åˆ°<code>initWithSize:</code>æ–¹æ³•ï¼Œå¹¶ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢é‡Œé¢çš„å†…å®¹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">id</span>)initWithSize:(<span class="built_in">CGSize</span>)size &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> initWithSize:size]) &#123;</div><div class="line"> </div><div class="line">        <span class="comment">// 1) Loading the background</span></div><div class="line">        _background = [<span class="built_in">SKSpriteNode</span> spriteNodeWithImageNamed:<span class="string">@"blue-shooting-stars"</span>];</div><div class="line">        [_background setName:<span class="string">@"background"</span>];</div><div class="line">        [_background setAnchorPoint:<span class="built_in">CGPointZero</span>];</div><div class="line">        [<span class="keyword">self</span> addChild:_background];</div><div class="line"> </div><div class="line">        <span class="comment">// 2) Loading the images</span></div><div class="line">        <span class="built_in">NSArray</span> *imageNames = @[<span class="string">@"bird"</span>, <span class="string">@"cat"</span>, <span class="string">@"dog"</span>, <span class="string">@"turtle"</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; [imageNames count]; ++i) &#123;</div><div class="line">          <span class="built_in">NSString</span> *imageName = [imageNames objectAtIndex:i];</div><div class="line">          <span class="built_in">SKSpriteNode</span> *sprite = [<span class="built_in">SKSpriteNode</span> spriteNodeWithImageNamed:imageName];</div><div class="line">          [sprite setName:kAnimalNodeName];</div><div class="line"> </div><div class="line">          <span class="keyword">float</span> offsetFraction = ((<span class="keyword">float</span>)(i + <span class="number">1</span>)) / ([imageNames count] + <span class="number">1</span>);</div><div class="line">          [sprite setPosition:<span class="built_in">CGPointMake</span>(size.width * offsetFraction, size.height / <span class="number">2</span>)];</div><div class="line">          [_background addChild:sprite];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹ä¸Šé¢çš„ä»£ç éƒ½å¹²äº†ä»€ä¹ˆã€‚</p>
<p>1) åŠ è½½èƒŒæ™¯å›¾ç‰‡</p>
<p>ä¸Šé¢æ–¹æ³•ä¸­çš„ç¬¬ä¸€éƒ¨åˆ†ä»£ç æ˜¯ä¸ºsceneåŠ è½½èƒŒæ™¯å›¾ç‰‡(blue-shooting-stars.png)ã€‚å¹¶å°†è¯¥noteçš„anchorè®¾ç½®ä¸ºå›¾ç‰‡çš„å·¦ä¸‹è§’(0, 0)ã€‚</p>
<p>åœ¨Sprite Kitä¸­ï¼Œè®¾ç½®ä¸€ä¸ªnodeçš„ä½ç½®æ—¶ï¼Œå®é™…ä¸Šæ˜¯è®¾ç½®å®ƒçš„anchorã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œnodeçš„anchorè¢«è®¾ç½®ä¸ºnodeçš„æ­£ä¸­é—´ã€‚åœ¨æ­¤ï¼Œå°†anchorè®¾ç½®ä¸ºå·¦ä¸‹è§’ã€‚</p>
<p>æ–¹æ³•ä¸­ï¼Œå¹¶æ²¡æœ‰è®¾ç½®èƒŒæ™¯å›¾ç‰‡çš„positionï¼Œæ‰€ä»¥èƒŒæ™¯å›¾çš„çš„ä½ç½®é»˜è®¤ä¸º(0,0)ã€‚æœ€ç»ˆï¼Œå›¾ç‰‡çš„å·¦ä¸‹è§’ä½ç½®æ˜¯(0,0)ï¼Œå¹¶å‘å³è¾¹å»¶ä¼¸ã€‚</p>
<p>2) åŠ è½½å°åŠ¨ç‰©</p>
<p>å‡½æ•°ä¸­æ¥ä¸‹æ¥çš„ä»£ç æ˜¯å¾ªç¯éå†åˆ—è¡¨ä¸­çš„å›¾ç‰‡ï¼Œå¹¶å°†å…¶åŠ è½½åˆ°sceneä¸­ã€‚ä¸ºäº†å¥½çš„å¸ƒå±€ï¼Œå…¶ä¸­å„ä¸ªnodeæ ¹æ®å±å¹•çš„é•¿åº¦æ¥å®šä½ï¼Œå¦å¤–è¿˜å°†è¿™äº›nodeçš„åå­—è®¾ç½®ä¸º<code>kAnimalNodeName</code>ã€‚</p>
<p>ä¹‹åå°†åˆ›å»ºå¥½çš„nodeæ·»åŠ åˆ°<code>_background</code>ä¸­ã€‚</p>
<p>OKï¼ç¼–è¯‘å¹¶è¿è¡Œç¨‹åºï¼Œä¼šçœ‹åˆ°å±å¹•ä¸­å·²ç»æ˜¾ç¤ºå‡ºäº†ä¸€äº›å¯çˆ±çš„åŠ¨ç‰©äº†ã€‚</p>
<p><img src="/images/2013/10/19.png" alt=""></p>
<p>###<a id="xzjs"></a>ç”¨è§¦æ‘¸çš„æ–¹å¼é€‰ä¸­sprite</p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹æ ¹æ®ç”¨æˆ·å½“å‰è§¦æ‘¸çš„ä½ç½®åˆ¤æ–­å‡ºå“ªä¸ªspriteåº”è¯¥è¢«é€‰ä¸­ã€‚</p>
<p>ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢<code>touchesBegan:withEvent:</code>ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-(<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</div><div class="line">    <span class="built_in">UITouch</span> *touch = [touches anyObject];</div><div class="line">    <span class="built_in">CGPoint</span> positionInScene = [touch locationInNode:<span class="keyword">self</span>];</div><div class="line">    [<span class="keyword">self</span> selectNodeForTouch:positionInScene];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é¦–å…ˆä»touches setä¸­è·å¾—touchã€‚ç„¶åå°†touchçš„ä½ç½®è½¬æ¢åˆ°ä¸€ä¸ªæŒ‡å®šnodeä¸­çš„ä½ç½®ï¼Œä¸Šé¢çš„ä»£ç ä¸­ä½¿ç”¨äº†sceneã€‚è®©åå°†è·å¾—çš„æ–¹æ³•ä¼ é€’ç»™<code>selectNodeForTouch:</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹è¿™ä¸ªæ–¹æ³•çš„å®ç°ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)selectNodeForTouch:(<span class="built_in">CGPoint</span>)touchLocation &#123;</div><div class="line">   <span class="comment">//1</span></div><div class="line">   <span class="built_in">SKSpriteNode</span> *touchedNode = (<span class="built_in">SKSpriteNode</span> *)[<span class="keyword">self</span> nodeAtPoint:touchLocation];</div><div class="line"> </div><div class="line">      <span class="comment">//2</span></div><div class="line">	<span class="keyword">if</span>(![_selectedNode isEqual:touchedNode]) &#123;</div><div class="line">		[_selectedNode removeAllActions];</div><div class="line">		[_selectedNode runAction:[<span class="built_in">SKAction</span> rotateToAngle:<span class="number">0.0</span>f duration:<span class="number">0.1</span>]];</div><div class="line"> </div><div class="line">		_selectedNode = touchedNode;</div><div class="line">		<span class="comment">//3</span></div><div class="line">		<span class="keyword">if</span>([[touchedNode name] isEqualToString:kAnimalNodeName]) &#123;</div><div class="line">			<span class="built_in">SKAction</span> *sequence = [<span class="built_in">SKAction</span> sequence:@[[<span class="built_in">SKAction</span> rotateByAngle:degToRad(<span class="number">-4.0</span>f) duration:<span class="number">0.1</span>],</div><div class="line">													  [<span class="built_in">SKAction</span> rotateByAngle:<span class="number">0.0</span> duration:<span class="number">0.1</span>],</div><div class="line">													  [<span class="built_in">SKAction</span> rotateByAngle:degToRad(<span class="number">4.0</span>f) duration:<span class="number">0.1</span>]]];</div><div class="line">			[_selectedNode runAction:[<span class="built_in">SKAction</span> repeatActionForever:sequence]];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ˜¯ä¸€ä¸ªhelperæ–¹æ³•ï¼Œå®ƒä¸»è¦åšä¸‰ä»¶ä¸åŒçš„äº‹æƒ…ï¼š</p>
<ol>
<li>é€šè¿‡scene(self)è·å¾—touchLocationä½ç½®å¯¹åº”çš„nodeã€‚</li>
<li>è·å¾—åŒ¹é…çš„nodeä¹‹åï¼Œæ£€æŸ¥ä¸€ä¸‹è¿™ä¸ªnodeä¸ä¸Šä¸€æ¬¡é€‰ä¸­çš„nodeæ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒçš„è¯ï¼Œåœ¨è¿™é‡Œç›´æ¥å°±è¿”å›äº†ã€‚å¦‚æœæ˜¯ä¸€ä¸ªæ–°é€‰ä¸­çš„nodeï¼Œæˆ–è€…è¿˜æ²¡æœ‰é€‰ä¸­è¿‡ï¼Œè¿™ä¸ªnodeä¼šæœ‰ä¸€ç‚¹å°å°çš„æŒªåŠ¨åŠ¨ç”»ï¼Œä»¥æ­¤å¯ä»¥çœ‹å‡ºå“ªä¸ªnodeè¢«é€‰ä¸­äº†ã€‚ä¸è¿‡åœ¨å¼€å§‹åŠ¨ç”»ä¹‹å‰ï¼Œéœ€è¦ç§»é™¤å½“å‰å·²ç»é€‰ä¸­nodeä¸Šçš„æ‰€æœ‰running actionsï¼Œå¹¶åœ¨è¿™ä¸ªnodeä¸Šè¿è¡Œä¸€ä¸ªactionï¼š<code>rotateToAngle:duration:</code>ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿åªæœ‰ä¸€ä¸ªnodeåœ¨åšåŠ¨ç”»ï¼Œè€Œå¦å¤–çš„nodeæ¢å¤åˆ°åŸæ ·ã€‚</li>
<li>è¿™ä¸ªifè¯­å¥ç”¨æ¥åˆ¤æ–­ä¸€ä¸‹é€‰ä¸­çš„nodeæ˜¯å¦å¯ä»¥è¿›è¡ŒåŠ¨ç”»(åªéœ€è¦æ£€æŸ¥ä¸€ä¸‹nodeçš„nameå°±å¯ä»¥åšå‡ºåˆ¤æ–­â€”â€”è¿˜è®°å¾—åœ¨<code>initWithSize:</code>æ–¹æ³•ä¸­è®¾ç½®çš„è¿™ä¸ªå±æ€§å€¼å—ï¼Ÿ)ã€‚å¦‚æœé€‰ä¸­çš„nodeå¯ä»¥åšåŠ¨ç”»å¤„ç†ï¼Œé‚£ä¹ˆå°±åˆ›å»ºä¸€ä¸ªsequence actionâ€”â€”æ˜¯ä¸€ä¸ªåŠ¨ç”»æ•ˆæœï¼Œå°±åƒåœ¨ä¸»å±å¹•ä¸­é‡æ’/åˆ é™¤ç¨‹åºé‚£æ ·çš„æ•ˆæœï¼Œç„¶ååœ¨é€‰ä¸­çš„nodeä¸Šè¿è¡Œè¿™ä¸ªsequenceã€‚ä¸ºäº†é¿å…åŠ¨ç”»è¿è¡Œå®Œæ¯•ä¹‹åä¼šåœæ­¢ï¼Œåœ¨è¿™é‡Œè¿è¡Œäº†ä¸€ä¸ªä¸€ç›´é‡å¤çš„actionã€‚</li>
</ol>
<p>ä¸‹é¢å°†helperå‡½æ•°<code>degToRad</code>æ·»åŠ åˆ°æ–‡ä»¶çš„åº•éƒ¨ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">float</span> degToRad(<span class="keyword">float</span> degree) &#123;</div><div class="line">	<span class="keyword">return</span> degree / <span class="number">180.0</span>f * M_PI;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç”±äºSprite Kitæ˜¯åˆ©ç”¨å¼§åº¦æ¥åšæ—‹è½¬æ•ˆæœçš„ï¼Œæ‰€ä»¥ä¸Šé¢è¿™ä¸ªæ–¹æ³•å°†è§’åº¦è½¬æ¢ä¸ºå¼§åº¦ã€‚</p>
<p>ç¼–è¯‘å¹¶è¿è¡Œç¨‹åºï¼Œç°åœ¨å¯ä»¥åœ¨å±å¹•ä¸Štapä¸€ä¸ªåŠ¨ç‰©ï¼Œå½“é€‰ä¸­æŸä¸ªåŠ¨ç‰©æ—¶ï¼Œè¯¥åŠ¨ç‰©ä¼šåšå‡ºç›¸åº”çš„åŠ¨ç”»æ•ˆæœï¼Œä»¥è¡¨ç¤ºè¢«é€‰ä¸­ï¼</p>
<p><img src="/images/2013/10/20.png" alt=""></p>
<p>###<a id="ydjl"></a>ç”¨è§¦æ‘¸çš„æ–¹å¼ç§»åŠ¨spriteå’Œlayer</p>
<p>ä¸‹é¢æ¥çœ‹çœ‹å¦‚ä½•ç§»åŠ¨è¿™äº›åŠ¨ç‰©ï¼åŸºæœ¬æ€è·¯æ˜¯è¿™æ ·çš„ï¼šå®ç°<code>touchesMoved:withEvent:</code>æ–¹æ³•ï¼Œè®¡ç®—å‡ºè·ç¦»ä¸Šä¸€æ¬¡è§¦æ‘¸ç§»åŠ¨äº†å¤šè¿œï¼Œå¦‚æœæœ‰åŠ¨ç‰©è¢«é€‰ä¸­ï¼ŒåŠ¨ç‰©å°†è¢«ç§»åŠ¨ç›¸åº”çš„è·ç¦»ï¼Œå¦‚æœæ²¡æœ‰é€‰ä¸­åŠ¨ç‰©ï¼Œé‚£ä¹ˆå°±ç§»åŠ¨æ•´ä¸ªlayerï¼Œè¿™æ ·ç”¨æˆ·å¯ä»¥ä»å·¦å‘å³çš„æ»šåŠ¨layerã€‚</p>
<p>åœ¨æ·»åŠ ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥æ¢è®¨ä¸€ä¸‹åœ¨Sprite Kitä¸­ï¼Œä¸€ä¸ªnodeæ˜¯å¦‚ä½•æ»šåŠ¨çš„ã€‚</p>
<p>çœ‹çœ‹ä¸‹é¢çš„å›¾ç‰‡ï¼š</p>
<p><img src="/images/2013/10/21.png" alt=""></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å·²ç»åˆå§‹åŒ–äº†ä¸€ä¸ªèƒŒæ™¯ï¼Œæ‰€ä»¥èƒŒæ™¯çš„anchorç‚¹æ˜¯(0, 0)ï¼Œå¹¶ä¸”å‘å³è¾¹æ‰©å±•ã€‚é»‘è‰²æ¡†ä¸­çš„åŒºåŸŸè¡¨ç¤ºå½“å‰çš„å¯è§†åŒºåŸŸ(windowçš„å¤§å°)ã€‚</p>
<p>å¦‚æœå¸Œæœ›å°†å›¾ç‰‡å¾€å³è¾¹æ»šåŠ¨100 pointsï¼Œå¯ä»¥é€šè¿‡å°†æ•´ä¸ªnodeå¾€å·¦è¾¹ç§»åŠ¨100 pointsï¼Œå¦‚ç¬¬äºŒå¹…å›¾çœ‹åˆ°çš„æ•ˆæœä¸€æ ·ã€‚</p>
<p>å½“ç„¶ï¼Œä¹Ÿå¯èƒ½å¸Œæœ›ä¸è¦ç§»åŠ¨å¤ªè¿œã€‚ä¾‹å¦‚ï¼Œä¸åº”è¯¥è®©layerå¯ä»¥å¾€å³è¾¹ç§»åŠ¨ï¼Œå¦åˆ™ä¼šçœ‹åˆ°ç©ºç™½çš„ç‚¹ã€‚</p>
<p>ä¸‹é¢æ¥çœ‹çœ‹ç›¸åº”çš„ä»£ç ï¼å°†å¦‚ä¸‹æ–¹æ³•æ·»åŠ åˆ°æ–‡ä»¶çš„åº•éƒ¨ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGPoint</span>)boundLayerPos:(<span class="built_in">CGPoint</span>)newPos &#123;</div><div class="line">    <span class="built_in">CGSize</span> winSize = <span class="keyword">self</span>.size;</div><div class="line">    <span class="built_in">CGPoint</span> retval = newPos;</div><div class="line">    retval.x = MIN(retval.x, <span class="number">0</span>);</div><div class="line">    retval.x = MAX(retval.x, -[_background size].width+ winSize.width);</div><div class="line">    retval.y = [<span class="keyword">self</span> position].y;</div><div class="line">    <span class="keyword">return</span> retval;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">- (<span class="keyword">void</span>)panForTranslation:(<span class="built_in">CGPoint</span>)translation &#123;</div><div class="line">    <span class="built_in">CGPoint</span> position = [_selectedNode position];</div><div class="line">    <span class="keyword">if</span>([[_selectedNode name] isEqualToString:kAnimalNodeName]) &#123;</div><div class="line">        [_selectedNode setPosition:<span class="built_in">CGPointMake</span>(position.x + translation.x, position.y + translation.y)];</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">CGPoint</span> newPos = <span class="built_in">CGPointMake</span>(position.x + translation.x, position.y + translation.y);</div><div class="line">        [_background setPosition:[<span class="keyword">self</span> boundLayerPos:newPos]];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¬¬ä¸€ä¸ªæ–¹æ³•<code>boundLayerPos:</code>æ˜¯ä¸ºäº†ç¡®ä¿ä¸ä¼šå°†layerç§»åŠ¨åˆ°èƒŒæ™¯å›¾ç‰‡èŒƒå›´ä¹‹å¤–ã€‚åœ¨è¿™é‡Œä¼ å…¥ä¸€ä¸ªéœ€è¦ç§»åŠ¨åˆ°çš„ä½ç½®ï¼Œç„¶åè¯¥æ–¹æ³•ä¼šå¯¹ä½ç½®åšé€‚å½“çš„åˆ¤æ–­å¤„ç†ï¼Œä»¥ç¡®ä¿ä¸ä¼šç§»åŠ¨å¤ªè¿œã€‚</p>
<p>æ¥ç€æ–¹æ³•<code>panForTranslation:</code>é¦–å…ˆåˆ¤æ–­ä¸€ä¸‹_selectedNodeæ˜¯å¦ä¸ºåŠ¨ç‰©nodeï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œæ ¹æ®ä¼ å…¥çš„å‚æ•°æ¥ä¸ºnodeè®¾ç½®æ–°çš„ä½ç½®ã€‚å¦‚æœæ˜¯background layerï¼ŒåŒæ ·ä¹Ÿä¼šè®¾ç½®ä¸€ä¸ªæ–°çš„ä½ç½®ï¼Œåªä¸è¿‡æ–°çš„ä½ç½®éœ€è¦è°ƒç”¨<code>boundLayerPos:</code>æ–¹æ³•è·å¾—ã€‚</p>
<p>å®Œæˆä¸Šé¢ä¹‹åï¼Œå¯ä»¥å®ç°<code>touchesMoved:withEvent:</code>æ–¹æ³•äº†ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)touchesMoved:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</div><div class="line">	<span class="built_in">UITouch</span> *touch = [touches anyObject];</div><div class="line">	<span class="built_in">CGPoint</span> positionInScene = [touch locationInNode:<span class="keyword">self</span>];</div><div class="line">	<span class="built_in">CGPoint</span> previousPosition = [touch previousLocationInNode:<span class="keyword">self</span>];</div><div class="line"> </div><div class="line">	<span class="built_in">CGPoint</span> translation = <span class="built_in">CGPointMake</span>(positionInScene.x - previousPosition.x, positionInScene.y - previousPosition.y);</div><div class="line"> </div><div class="line">	[<span class="keyword">self</span> panForTranslation:translation];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è·Ÿ<code>touchesBegan:withEvent:</code>ä¸€æ ·ï¼Œå…ˆè·å¾—touchï¼Œç„¶åå°†å®ƒçš„ä½ç½®è½¬æ¢ä¸ºsceneä¸­çš„ç›¸åº”ä½ç½®ã€‚ä¸ºäº†è®¡ç®—å‡ºç§»åŠ¨çš„è·ç¦»ï¼Œéœ€è¦ä¸Šä¸€æ¬¡è§¦æ‘¸çš„ä½ç½®ã€‚</p>
<p>é€šè¿‡å½“å‰ä½ç½®å‡å»ä¸Šä¸€æ¬¡çš„ä½ç½®å°±å¯ä»¥è®¡ç®—å‡ºéœ€è¦ç§»åŠ¨çš„è·ç¦»äº†ã€‚æœ€åè°ƒç”¨<code>panForTransaltion:</code>æ–¹æ³•ï¼Œå¹¶å°†ç§»åŠ¨è·ç¦»ä¼ å…¥å³å¯ã€‚</p>
<p>æå®šï¼ç¼–è¯‘å¹¶è¿è¡Œç¨‹åºï¼Œç°åœ¨å¯ä»¥é€šè¿‡æ‹–æ”¾çš„æ–¹å¼ç§»åŠ¨sprite(ä»¥åŠlayer)äº†ï¼</p>
<p><img src="/images/2013/10/22.png" alt=""></p>
<p>###<a id="sssb"></a>åœ¨Sprite Kitä¸­å¦‚ä½•ä½¿ç”¨æ‰‹åŠ¿è¯†åˆ«</p>
<p>åœ¨Sprite Kitä¸­è¿˜å¯ä»¥ä½¿ç”¨æ‰‹åŠ¿è¯†åˆ«æ¥å¤„ç†è§¦æ‘¸ï¼</p>
<p>æ‰‹åŠ¿è¯†åˆ«å¯ä»¥è¯†åˆ«ä¸åŒçš„æ‰‹åŠ¿ï¼Œå¦‚tapï¼Œdouble tapï¼Œswipeæˆ–panã€‚</p>
<p>é€šè¿‡æ‰‹åŠ¿è¯†åˆ«ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨å†™å¤§é‡çš„ä»£ç æ¥è¯†åˆ«ä¸åŒçš„æ‰‹åŠ¿ï¼ˆå¦‚tapï¼Œdouble tapï¼Œswipeæˆ–panï¼‰ï¼Œåªéœ€è¦åˆ›å»ºä¸€ä¸ªæ‰‹åŠ¿è¯†åˆ«å¯¹è±¡å¹¶å°†å…¶æ·»åŠ åˆ°viewä¸­ï¼Œå³å¯è¿›è¡Œæ‰‹åŠ¿è¯†åˆ«ã€‚å½“æœ‰æ‰‹åŠ¿å‘ç”Ÿï¼Œä¼šæœ‰ä¸€ä¸ªå›è°ƒã€‚</p>
<p>ä¸‹é¢å°±æ¥çœ‹çœ‹å¦‚ä½•åœ¨Sprite Kitä¸­ä½¿ç”¨æ‰‹åŠ¿è¯†åˆ«ã€‚</p>
<p>é¦–å…ˆï¼Œæ³¨é‡Šæ‰è§¦æ‘¸å¤„ç†æ–¹æ³•ï¼š<code>touchesBegan:withEvent:</code>å’Œ<code>touchesMoved:withEvent:</code>(å› ä¸ºè¦ä½¿ç”¨ä¸åŒçš„å¤„ç†æ–¹æ³•å•¦)ã€‚</p>
<p>ç„¶åæ·»åŠ å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)didMoveToView:(<span class="built_in">SKView</span> *)view &#123;</div><div class="line">    <span class="built_in">UIPanGestureRecognizer</span> *gestureRecognizer = [[<span class="built_in">UIPanGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(handlePanFrom:)];</div><div class="line">    [[<span class="keyword">self</span> view] addGestureRecognizer:gestureRecognizer];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“sceneç¬¬ä¸€æ¬¡æ˜¾ç¤ºå‡ºæ¥æ—¶ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚åœ¨ä¸Šé¢çš„æ–¹æ³•ä¸­åˆ›å»ºäº†ä¸€ä¸ªpanæ‰‹åŠ¿è¯†åˆ«å™¨ï¼Œå¹¶ç”¨å½“å‰çš„sceneæ¥å¯¹å…¶åšåˆå§‹åŒ–ï¼Œå¦å¤–è¿˜ä¼ å…¥ä¸€ä¸ªcallbackï¼š<code>handlePanFrom:</code>ã€‚æ¥ç€æŠŠè¿™ä¸ªæ‰‹åŠ¿è¯†åˆ«å™¨æ·»åŠ åˆ°sceneä¸­çš„viewé‡Œé¢ã€‚</p>
<p>æ³¨æ„ï¼šå¯èƒ½ä½ ä¼šé—®ä¸ºä»€ä¹ˆè¦åœ¨è¿™é‡Œæ·»åŠ è¯†åˆ«å™¨ï¼Œè€Œä¸æ˜¯åœ¨sceneçš„initæ–¹æ³•ä¸­ã€‚ç­”æ¡ˆå¾ˆç®€å•ï¼š<code>SKScene</code>æœ‰ä¸€ä¸ªviewå±æ€§ï¼Œä¿å­˜ç€SKViewâ€”â€”è¯¥viewç”¨æ¥æ˜¾ç¤ºsceneï¼Œä¸è¿‡åªæœ‰sceneæ˜¾ç¤ºåˆ°å±å¹•ä¸­æ—¶è¿™ä¸ªå±æ€§æ‰ä¼šè¢«åˆå§‹åŒ–ï¼Œæ‰€ä»¥åœ¨initæ–¹æ³•è¢«è°ƒç”¨æ—¶è¯¥å±æ€§æ˜¯nilçš„ã€‚æ­¤å¤„çš„<code>didMoveToView:</code>ç±»ä¼¼äºUIKitä¸­çš„<code>viewDidAppear:</code>ï¼Œå½“sceneæ˜¾ç¤ºå‡ºæ¥æ—¶ï¼Œ<code>didMoveToView:</code>ä¼šè¢«è°ƒç”¨ã€‚</p>
<p>æ¥ç€ï¼Œå°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°<code>MyScene.m</code>æ–‡ä»¶åº•éƒ¨ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)handlePanFrom:(<span class="built_in">UIPanGestureRecognizer</span> *)recognizer &#123;</div><div class="line">	<span class="keyword">if</span> (recognizer.state == <span class="built_in">UIGestureRecognizerStateBegan</span>) &#123;</div><div class="line"> </div><div class="line">        <span class="built_in">CGPoint</span> touchLocation = [recognizer locationInView:recognizer.view];</div><div class="line"> </div><div class="line">        touchLocation = [<span class="keyword">self</span> convertPointFromView:touchLocation];</div><div class="line"> </div><div class="line">        [<span class="keyword">self</span> selectNodeForTouch:touchLocation];</div><div class="line"> </div><div class="line"> </div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (recognizer.state == <span class="built_in">UIGestureRecognizerStateChanged</span>) &#123;</div><div class="line"> </div><div class="line">        <span class="built_in">CGPoint</span> translation = [recognizer translationInView:recognizer.view];</div><div class="line">        translation = <span class="built_in">CGPointMake</span>(translation.x, -translation.y);</div><div class="line">        [<span class="keyword">self</span> panForTranslation:translation];</div><div class="line">        [recognizer setTranslation:<span class="built_in">CGPointZero</span> inView:recognizer.view];</div><div class="line"> </div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (recognizer.state == <span class="built_in">UIGestureRecognizerStateEnded</span>) &#123;</div><div class="line"> </div><div class="line">        <span class="keyword">if</span> (![[_selectedNode name] isEqualToString:kAnimalNodeName]) &#123;</div><div class="line">            <span class="keyword">float</span> scrollDuration = <span class="number">0.2</span>;</div><div class="line">            <span class="built_in">CGPoint</span> velocity = [recognizer velocityInView:recognizer.view];</div><div class="line">            <span class="built_in">CGPoint</span> pos = [_selectedNode position];</div><div class="line">            <span class="built_in">CGPoint</span> p = mult(velocity, scrollDuration);</div><div class="line"> </div><div class="line">            <span class="built_in">CGPoint</span> newPos = <span class="built_in">CGPointMake</span>(pos.x + p.x, pos.y + p.y);</div><div class="line">            newPos = [<span class="keyword">self</span> boundLayerPos:newPos];</div><div class="line">            [_selectedNode removeAllActions];</div><div class="line"> </div><div class="line">            <span class="built_in">SKAction</span> *moveTo = [<span class="built_in">SKAction</span> moveTo:newPos duration:scrollDuration];</div><div class="line">            [moveTo setTimingMode:<span class="built_in">SKActionTimingEaseOut</span>];</div><div class="line">            [_selectedNode runAction:moveTo];</div><div class="line">        &#125;</div><div class="line"> </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“æ‰‹åŠ¿å¼€å§‹ã€æ”¹å˜(ä¾‹å¦‚ç”¨æˆ·æŒç»­drag)ï¼Œä»¥åŠç»“æŸæ—¶ï¼Œä¸Šé¢è¿™ä¸ªcallbackå‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨ã€‚è¯¥æ–¹æ³•ä¼šè¿›å…¥ä¸åŒçš„caseï¼Œä»¥å¤„ç†ä¸åŒçš„æƒ…å†µã€‚</p>
<p>å½“æ‰‹åŠ¿å¼€å§‹æ—¶ï¼Œå°†åæ ‡ç³»ç»Ÿè½¬æ¢ä¸ºnodeåæ ‡ç³»(æ³¨æ„è¿™é‡Œæ²¡æœ‰ä¾¿æ·çš„æ–¹æ³•ï¼Œåªèƒ½è¿™æ ·å¤„ç†)ã€‚ç„¶åç”µæ³³ä¹‹å‰å†™çš„helperæ–¹æ³•<code>selectNodeForTouch:</code>ã€‚</p>
<p>å½“æ‰‹åŠ¿å‘ç”Ÿæ”¹å˜æ—¶ï¼Œéœ€è¦è®¡ç®—å‡ºæ‰‹åŠ¿ç§»åŠ¨çš„é‡ã€‚è¿˜åœ¨æ‰‹åŠ¿è¯†åˆ«å™¨å·²ç»ä¸ºæˆ‘ä»¬å­˜å‚¨äº†æ‰‹åŠ¿ç§»åŠ¨çš„ç´¯è®¡é‡(translation)ï¼ä¸è¿‡è€ƒè™‘åˆ°æ•ˆæœçš„å·®å¼‚ï¼Œæˆ‘ä»¬éœ€è¦åœ¨UIKitåæ ‡ç³»å’ŒSprite Kitåæ ‡ç³»ä¸­å¯¹åæ ‡è¿›è¡Œè½¬æ¢ã€‚</p>
<p>å¹³ç§»(pan)ä¹‹åï¼Œéœ€è¦æŠŠæ‰‹åŠ¿è¯†åˆ«å™¨ä¸Šçš„translationè®¾ç½®ä¸º0ï¼Œå¦åˆ™è¯¥å€¼ä¼šç»§ç»­è¢«ç´¯åŠ ã€‚</p>
<p>å½“æ‰‹åŠ¿ç»“æŸä¹‹åï¼Œä¸Šé¢çš„å‡½æ•°ä¸­æœ‰ä¸€äº›æœ‰è¶£çš„ä»£ç ï¼UIPanGestureRecognizerå¯ä»¥ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªç§»åŠ¨çš„é€Ÿåº¦ã€‚é€šè¿‡è¿™ä¸ªé€Ÿåº¦å¯ä»¥å¯¹nodeåšä¸€ä¸ªåŠ¨ç”»â€”â€”æ»‘åŠ¨ä¸€å°ç‚¹ï¼Œè¿™æ ·ç”¨æˆ·å¯ä»¥å¯¹nodeåšä¸€ä¸ªå¿«é€Ÿçš„æ‘‡åŠ¨ï¼Œå°±åƒtable viewä¸Šçš„é‚£ç§æ•ˆæœä¸€æ ·ã€‚</p>
<p>æ‰€ä»¥ï¼Œåœ¨è¿™é‡ŒåŒ…å«çš„ä»£ç ç”¨æ¥è®¡ç®—åŸºäºé€Ÿåº¦ç§»åŠ¨çš„ä¸€ä¸ªpointï¼Œç„¶åè¿è¡Œä¸€ä¸ªmoveTo action(ä¸ºäº†æ›´åŠ å¥½çœ‹ï¼Œé™„å¸¦<code>SKActionTimingEaseOut</code>æ•ˆæœ)ã€‚</p>
<p>æ¥ç€æ·»åŠ å¦‚ä¸‹ä¸€ä¸ªæ–¹æ³•åˆ°æ–‡ä»¶ä¸­ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CGPoint</span> mult(<span class="keyword">const</span> <span class="built_in">CGPoint</span> v, <span class="keyword">const</span> <span class="built_in">CGFloat</span> s) &#123;</div><div class="line">	<span class="keyword">return</span> <span class="built_in">CGPointMake</span>(v.x*s, v.y*s);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ä¸ªæ–¹æ³•æ˜¯å°†æ»šåŠ¨çš„æ—¶é—´ä¹˜ä»¥é€Ÿåº¦ã€‚</p>
<p>ç¼–è¯‘å¹¶è¿è¡Œç¨‹åºï¼Œç°åœ¨åº”è¯¥å¯ä»¥ç”¨æ‰‹åŠ¿è¯†åˆ«å™¨æ»‘åŠ¨å’Œç§»åŠ¨åŠ¨ç‰©äº†ã€‚</p>
<p><img src="/images/2013/10/23.png" alt=""></p>
<p>###<a id="hqhc"></a>ä½•å»ä½•ä»</p>
<p>æœ¬æ–‡çš„ä»£ç å·¥ç¨‹åœ¨<a href="http://cdn2.raywenderlich.com/downloads/DragDropSpriteKit.zip" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<p>è‡³æ­¤ï¼Œä½ åº”è¯¥çŸ¥é“å¦‚ä½•åœ¨Sprite Kitç¨‹åºä¸­ä½¿ç”¨touchæ¥ç§»åŠ¨nodeï¼Œä»¥åŠå¦‚ä½•åœ¨Sprite Kitä¸­ä½¿ç”¨æ‰‹åŠ¿è¯†åˆ«å™¨ã€‚</p>
<p>ç°åœ¨ï¼Œä½ ä¹Ÿå¯ä»¥å°è¯•åˆ©ç”¨åˆ«çš„æ‰‹åŠ¿è¯†åˆ«å™¨å¯¹ä¸Šé¢çš„å·¥ç¨‹åšæ‰©å±•å¤„ç†ï¼Œä¾‹å¦‚pinchæˆ–rotateæ‰‹åŠ¿è¯†åˆ«å™¨â€”â€”å¯ä»¥è®©çŒ«é•¿å¤§å“¦ï¼</p>
<p>å¦‚æœä½ å¸Œæœ›å­¦ä¹ æ›´å¤šç›¸å…³Sprite Kitå†…å®¹ï¼Œå¯ä»¥çœ‹çœ‹è¿™æœ¬ä¹¦ï¼š<a href="http://www.raywenderlich.com/store/ios-7-by-tutorials" target="_blank" rel="external">iOS Games by Tutorials</a>ã€‚æœ¬ä¹¦ä¼šå‘Šè¯‰ä½ éœ€è¦çŸ¥é“çš„å†…å®¹â€”â€”ä»ç‰©ç†ç‰¹æ€§ï¼Œåˆ°ç£è´´åœ°å›¾ï¼Œä»¥åŠç²’å­ç³»ç»Ÿï¼Œç”šè‡³æ˜¯åˆ¶ä½œè‡ªå·±çš„å…³å¡ç¼–è¾‘å™¨ã€‚</p>

      
    </div>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2013/10/27/2013-10-19-118-sprite-kit-tutorial-making-a-universal-app-part-1/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          Sprite Kitæ•™ç¨‹ï¼šåˆ¶ä½œä¸€ä¸ªé€šç”¨ç¨‹åº 1
        
      </div>
    </a>
  
  
    <a href="/2013/10/16/2013-10-16-116-spritekit-tutorial-animations-and-texture-atlases-2/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Sprite Kitæ•™ç¨‹ï¼šåŠ¨ç”»å’Œçº¹ç†å›¾é›† 2</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">åˆ†äº«åˆ°ï¼š</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- å¤šè¯´è¯„è®ºæ¡† start -->
	<div class="ds-thread" data-thread-key="2013-10-19-117-spritekit-tutorial-how-to-drag-and-drop-sprites" data-title="Sprite Kitæ•™ç¨‹ï¼šå¦‚ä½•æ‹–æ”¾Sprites" data-url="http://beyondvincent.com/2013/10/20/2013-10-19-117-spritekit-tutorial-how-to-drag-and-drop-sprites/"></div>
	<!-- å¤šè¯´è¯„è®ºæ¡† end -->
	<!-- å¤šè¯´å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"beyondvincent"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- å¤šè¯´å…¬å…±JSä»£ç  end -->
</div>




      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 ç ´èˆ¹ä¹‹å®¶
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>
  <script src="/js/main.js"></script>

  </div>
</body>
</html>